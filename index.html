<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=.6">
        <title>Fluffpumpkin Studios</title>
        <link rel="stylesheet" href="scripts/styles.css">
    </head>
    <body>

        <script>NekoType="lucky"</script>
        <h1 id=nl><script src="https://webneko.net/n20171213.js"></script><a 
        href="https://webneko.net">Neko</a></h1>

        <div class="div-container">
            <div class="header">
                <img src="images/oldHeader.gif">
            </div>
            <div class="content">
                <div class="navbar aligned">
                    <a href="pages/home.html" target="innerframe"><img class="pixeled navbutton" src="images/buttons/home.gif" onmouseover="this.setAttribute('src', 'images/buttons/home_open.gif')" onmouseout="if(current != 'home') this.setAttribute('src', 'images/buttons/home.gif')"></a><br>
                    <a href="pages/about.html" target="innerframe"><img class="pixeled navbutton" src="images/buttons/about.gif" onmouseover="this.setAttribute('src', 'images/buttons/about_open.gif')" onmouseout="if(current != 'about') this.setAttribute('src', 'images/buttons/about.gif')"></a><br>
                    <a href="pages/archive.html" target="innerframe"><img class="pixeled navbutton" src="images/buttons/archive.gif" onmouseover="this.setAttribute('src', 'images/buttons/archive_open.gif')" onmouseout="if(current != 'archive') this.setAttribute('src', 'images/buttons/archive.gif')"></a><br>
                    <a href="pages/gallery.html" target="innerframe"><img class="pixeled navbutton" src="images/buttons/gallery.gif" onmouseover="this.setAttribute('src', 'images/buttons/gallery_open.gif')" onmouseout="if(current != 'gallery') this.setAttribute('src', 'images/buttons/gallery.gif')"></a><br>
                    <a href="pages/webring.html" target="innerframe"><img class="pixeled navbutton" src="images/buttons/webring.gif" onmouseover="this.setAttribute('src', 'images/buttons/webring_open.gif')" onmouseout=" if(current != 'webring') this.setAttribute('src', 'images/buttons/webring.gif')"></a><br>
                </div>
                <div class="main aligned"><iframe id="innerframe" class="innerframe" name="innerframe" src="pages/home.html" onLoad="updateURL();"></iframe></div>
                <div class="aligned" style="width:10%"></div>
            </div>
            <div class="footer">
                <p>&#169;Fluffpumpkin Studios 2020-2025<br>
                <a href="https://www.fluffpumpkin.net/">https://www.fluffpumpkin.net/</a></p>
            </div>
        </div>

        <script>
            innerframe = document.getElementById("innerframe")
            current = "home"

            function updateURL(){
                request = innerframe.contentWindow.location.href
                tag1 = request.split('/')
                tag2 = tag1[4].split('.html')
                tag3 = tag2[1].split('?')
                if (tag3[1] == undefined) {window.history.replaceState('null', 'Fluffpumpkin Studios', '?p:' + tag2[0]);}
                else{window.history.replaceState('null', 'Fluffpumpkin Studios', '?p:' + tag2[0] + ';s:' + tag3[1]);}
                current = tag2[0];
                var images = document.querySelectorAll('img[src*="_open.gif"]');
                images.forEach(function(element) {
                    element.setAttribute('src', 'images/buttons/' + element.src.split('_open.gif')[0].split('images/buttons/')[1] + '.gif');
                });
                var cimg = document.querySelector('img[src*="' + current + '.gif"]');
                cimg.setAttribute('src', 'images/buttons/' + current + '_open.gif');
                //history.replaceState('data to be passed', 'Title of the page', '/test');
            }
            function getPage(){
                url = window.location.href;
                request = url.substring(url.lastIndexOf('/') + 1).split('?')[1];
                tags = request.split(';');
                p = null;
                s = null;
                for(i = 0; i < tags.length; i++){
                    tag = tags[i];
                    type = tag.split(':')[0];
                    value = tag.split(':')[1];
                    if(type == 'p' && p == null){
                        p = "pages/" + value + ".html";
                    }
                    if(type == 's' && s == null){
                        s = "?" + value;
                    }
                }
                if(p != null && s != null){
                    innerframe.src = p + s;
                }
                else if(p != null){
                    innerframe.src = p;
                }
            }
            getPage();
        </script>
    </body>
</html>